package pubsub

import (
	log "github.com/robpaul9/golog"

	"github.com/robpaul9/cloud-object-malware-scanner/adapters/redis"
	"github.com/robpaul9/cloud-object-malware-scanner/models"
)

type Config struct {
	Logger         log.Logger
	RedisInterface *redis.Service
}

type Service struct {
	*Config
}

func New(config *Config) *Service {
	return &Service{
		Config: config,
	}
}

func (s *Service) Publish(message models.PublishedMessage) (string, error) {
	r, err := s.RedisInterface.Publish(message)
	if err != nil {
		s.Logger.Error("unable to publish message", err)
		return "", nil
	}

	s.Logger.Info("message published: ", r)

	return "", nil

}
